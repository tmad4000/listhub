{% extends "base.html" %}
{% block title %}@{{ profile_user.username }} — ListHub{% endblock %}
{% block content %}
<div class="profile-header">
    <h1>{{ profile_user.display_name or profile_user.username }}</h1>
    <div class="username">@{{ profile_user.username }}</div>
</div>

{% if items %}

<div style="display: flex; justify-content: flex-end; margin-bottom: 12px;">
    <div class="view-toggle">
        <a href="/@{{ profile_user.username }}" class="btn btn-sm {% if view_mode != 'folders' %}btn-active{% endif %}" title="List view">List</a>
        <a href="/@{{ profile_user.username }}?view=folders" class="btn btn-sm {% if view_mode == 'folders' %}btn-active{% endif %}" title="Folder view">Folders</a>
    </div>
</div>

{% if view_mode == 'folders' and folder_tree is not none %}
{# ── Tree view ── #}
{% set tree_owner = profile_user.username %}
{% set tree_editable = false %}
{% include 'tree.html' %}
<script src="{{ url_for('static', filename='tree.js') }}"></script>

{% else %}
{# ── List view (default) ── #}
<div class="item-list">
    {% for item in items %}
    <div class="item-card">
        <div class="item-info">
            <a href="/@{{ profile_user.username }}/{{ item.slug }}" class="item-title">{{ item.title or item.slug }}</a>
            <div class="item-meta">
                <span class="badge badge-{{ item.item_type }}">{{ item.item_type }}</span>
                {% for tag in item.tags %}
                    <span class="tag">{{ tag }}</span>
                {% endfor %}
                <span>{{ item.updated_at[:10] if item.updated_at else '' }}</span>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

{% else %}
<div class="empty-state">
    <p>No public items yet.</p>
</div>
{% endif %}
{% endblock %}
